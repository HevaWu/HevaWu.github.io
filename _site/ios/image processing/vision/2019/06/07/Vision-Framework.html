<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Heva Wu's Blog - Vision Framework</title>
    <meta name="viewport" content="width=device-width">

    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

    <!-- Responsive CSS -->
    <link rel="stylesheet" href="/css/responsive.css">

    <!-- Google Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:300,400,700' rel='stylesheet' type='text/css'>
</head>

<body>
  <div class="site">
    <div class="sidebar" id="sidebar">
      <div class="header">
        <h1 class="title"><a href="/about" ><img id="logo" src="/images/logo.png"></a></h1>
        <span class="tagline">Heva Wu's Blog</span>
        <span class="motto">I may not be there yet, but I'm closer than I was yesterday. </span>
        <span class="motto">(￣︶￣)↗[GO!]</span>
      </div>
      <div class="sidebar-info">
        <ul class="sidebar-info-list">
          <li class="sidebar-info-link">
              <a href="/blog/tags" class="">Tags</a> <span class="separator">&bull;</span>
          </li>
          <li>
              <a href="/blog/categories" class="">Categories</a> <span class="separator">&bull;</span>
          </li>
          <li>
              <a href="/blog.html" class="footer-link">Latest Blog</a>
          </li>
        </ul>
      </div>
      <div class="footer">
        <span id="footer-links">
          <a href="/about" class="footer-link">About</a> <span class="separator">&bull;</span>
          <a href="https://www.linkedin.com/in/he-heva-wu-2a6819113/" class="footer-link">LinkedIn</a> <span class="separator">&bull;</span>
          <a href="https://github.com/HevaWu" class="footer-link">GitHub</a>
        </span>
      </div>
    </div>

    <div class="content" id="home">
  <div id="sidebar-button">
    <img src="/images/sidebar-button.png">
  </div>

  <div id="post-info">
    <div id="cover-photo-container">
      
    </div>
    <div id="info-container">
      <h1 id="title">Vision Framework</h1>
      <time datetime="2019-06-07T23:35:00+09:00" itemprop="datePublished">
        Jun 7, 2019
      </time>
      <div id="tag-category-container">
           
          
          <a href="/blog/tags/#ios" class="post-tag">iOS</a>
          
          <a href="/blog/tags/#image-processing" class="post-tag">Image Processing</a>
          
          <a href="/blog/tags/#vision" class="post-tag">Vision</a>
          
          
          <p></p>
           
          
          <a href="/blog/categories/#ios" class="post-category">iOS</a>
          
          <a href="/blog/categories/#image-processing" class="post-category">Image Processing</a>
          
          <a href="/blog/categories/#vision" class="post-category">Vision</a>
          
          
      </div>
    </div>
  </div>

  <div class="post">
    <p>Since WWDC 2018, Apple introduces the <code class="highlighter-rouge">Vision</code> Framework.
And I’d like to take some nots on it.</p>

<h1 id="saliency">Saliency</h1>

<p>Saliency generated people’s attension &amp; objectness.
Highlight when people watch the image.</p>

<p>Attention Based</p>
<ul>
  <li>Human Aspected</li>
  <li>Trained on eye movements</li>
</ul>

<p>Objectness Based</p>
<ul>
  <li>Foreground Objects</li>
  <li>Trained on object segmentation</li>
</ul>

<p>Here is an example image:
The first picture is the original picture
The second is attention based picture
The third is objectness based picture
<img src="/images/2019-06-07-Vision-Framework/attention_objectness.png" width="100%" /></p>

<h2 id="determined-by">Determined by</h2>
<ul>
  <li>Contrast</li>
  <li>Faces</li>
  <li>Subjects</li>
  <li>Horizons</li>
  <li>Light</li>
</ul>

<h2 id="heatmap">Heatmap</h2>
<p>Use <code class="highlighter-rouge">VNGenerateAttensionBasedSaliencyImageRequest</code> &amp; <code class="highlighter-rouge">VNGenerateObjectnessBasedSaliencyImageRequest</code>
to generate the image with the highlight picture.
The highlight part is covered by a heatmap, which point out the Saliency part.
<img src="/images/2019-06-07-Vision-Framework/saliency_example_code.png" width="100%" /></p>

<h2 id="bounding-box">Bounding Box</h2>
<p>For attension of the saliency, we will have a bounding box, which
could draw out the correct image area.</p>

<p>Here is an example code about how to adding th bounding box and showing it.
<img src="/images/2019-06-07-Vision-Framework/saliency_boundbox.png" width="100%" /></p>

<h2 id="graphical-uses">Graphical Uses</h2>
<p>Add type of filter or photo transition.
<img src="/images/2019-06-07-Vision-Framework/saliency_graphic_uses.png" width="100%" /></p>

<h1 id="image-classification">Image Classification</h1>
<ol>
  <li>Use saliency to detect the object &amp; return the bounding box-es</li>
  <li>For each bounding box, use image classification to find out which object it is.</li>
</ol>

<h2 id="taxonomy">Taxonomy</h2>
<p>Hierarchical structure, containing around 100 classes.
Grouping based on shared semantic meanings.
Define relationships between classes of increasing specificity.</p>

<h3 id="taxonomy-construction">Taxonomy Construction</h3>
<p>Include classes that are visually identifiable</p>

<p><em>Avoid</em></p>
<ul>
  <li>Abstract /controversial concepts</li>
  <li>Proper nouns, adjectives, and basic shapes</li>
  <li>Occupations</li>
</ul>

<p>Here is the result of classify image
<img src="/images/2019-06-07-Vision-Framework/image_classification.png" width="100%" /></p>

<p><em>Terms</em>
Confidence &gt; Threshold =&gt; Predicted image</p>
<ul>
  <li>Precision and Recall</li>
</ul>

<p>Add <code class="highlighter-rouge">hasMinimumPrecision</code> &amp; <code class="highlighter-rouge">Recall</code> params to help filtering the high precision images.
<img src="/images/2019-06-07-Vision-Framework/image_classify_recall.png" width="100%" /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- PR Curve &lt;img src="/images/2019-06-07-Vision-Framework/image_pr_curve.png" width="100%"&gt;

- Use Recall &amp; Precision to controll get the high precision &lt;img src="/images/2019-06-07-Vision-Framework/filter_pr_curve.png" width="100%"&gt;
</code></pre></div></div>

<h2 id="summary">Summary</h2>
<p>Returned observation contains labels and an associated confidence.
Choice of threshold is application specific.
Can be determined by desired precision and recall.</p>

<h1 id="image-similarity">Image Similarity</h1>
<p><img src="/images/2019-06-07-Vision-Framework/image_similarity.png" width="100%" /></p>

<p>Descriptor should describes image content, not just appearance.
Classification network creates representations of images.
FeaturePrint - vector image descriptor similar to a word vector.</p>

<h2 id="demo">Demo</h2>
<p><img src="/images/2019-06-07-Vision-Framework/demo_image_similarity.png" width="100%" /></p>

<h1 id="face-technology">Face Technology</h1>
<h2 id="face-landmarks">Face Landmarks</h2>
<p><img src="/images/2019-06-07-Vision-Framework/face_landmarks.png" width="100%" />
<img src="/images/2019-06-07-Vision-Framework/face_landmarks_demo.png" width="100%" /></p>

<p><code class="highlighter-rouge">VNDetectedObjectObservation</code> contain bounding Box -&gt; <code class="highlighter-rouge">VNFaceObservation</code>(landmarks)
<code class="highlighter-rouge">VNFaceLandmarks</code> confidence -&gt; <code class="highlighter-rouge">VNFaceLandmarks2D</code> (eyes…)</p>

<p>Revision Example – default versus explicit
<img src="/images/2019-06-07-Vision-Framework/face_landmarks_revision.png" width="100%" />
76points -&gt; 2019 SDK</p>

<h2 id="face-capture-quality">Face Capture Quality</h2>
<p>Face Capture Quality is a holistic measure that considers:
lighting, blur, occlusion, expression, pose, …
<img src="/images/2019-06-07-Vision-Framework/face_capture_quality.png" width="100%" /></p>

<p>Face capture quality should not be compared against a threshold.
Face capture quality is a <code class="highlighter-rouge">comparative</code> measure of the <code class="highlighter-rouge">same</code> subject.</p>

<h1 id="new-detector">New Detector</h1>
<ul>
  <li>Human Detector</li>
  <li>Cat and Dog Detector
<img src="/images/2019-06-07-Vision-Framework/new_detectors.png" width="100%" /></li>
</ul>

<h1 id="tracking-enhancements">Tracking Enhancements</h1>
<p>Less expansion into the background
Better handling of occlusions
Machine Learning based
Runs on CPU, GPU, and A12 Bionic with low power consumption
<img src="/images/2019-06-07-Vision-Framework/tracking_vision.png" width="100%" /></p>
<ul>
  <li><code class="highlighter-rouge">VNSequenceRequestHandler()</code></li>
  <li><code class="highlighter-rouge">inputObservation</code>
could add revision -&gt; <code class="highlighter-rouge">request.revision = VNTrackObjectRequestRevision2</code></li>
</ul>

<h1 id="vision-and-coreml-integration-enhancements">Vision and CoreML Integration Enhancements</h1>
<p>Vision now works with CoreML models that have <code class="highlighter-rouge">single input</code> of <code class="highlighter-rouge">image type</code>
Vision converts <code class="highlighter-rouge">Inputs</code> image to CoreML required input size and color scheme
Vision wraps <code class="highlighter-rouge">Outputs</code> into appropriate Observation types
<img src="/images/2019-06-07-Vision-Framework/vision_coreML.png" width="100%" /></p>

<p>Vision can now work with CoreML models that have <code class="highlighter-rouge">one or more</code> <code class="highlighter-rouge">Inputs</code></p>
<ul>
  <li>Including <code class="highlighter-rouge">multi-image</code> inputs
Vision will use <code class="highlighter-rouge">name-mapping</code> of <code class="highlighter-rouge">Output</code> names to Observations</li>
</ul>

<p><img src="/images/2019-06-07-Vision-Framework/vision_coreML_api.png" width="100%" /></p>


  </div>
  <div class="colophon">
    <p>
      <span id="pub-date">Published on 07 Jun 2019</span> <span class="separator">&bull;</span>
      <span id="social">Find me on <a href="">Twitter</a>!</span>
    </p>
  </div>

  <!-- Add Disqus comments. -->
  <div id="disqus_thread"></div>
  <script src="/scripts/disqus.js" type="text/javascript"></script>
  <script id="dsq-count-scr" src="//hevawu-github-io.disqus.com/count.js" async></script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>


  </div>
  <script src="/scripts/responsive.js" type="text/javascript"></script>
</body>

</html>