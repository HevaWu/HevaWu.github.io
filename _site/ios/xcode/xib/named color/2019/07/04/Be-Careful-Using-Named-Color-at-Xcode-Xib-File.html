<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Heva Wu's Blog - Be Careful Using `Named Color` at Xcode Xib File</title>
    <meta name="viewport" content="width=device-width">

    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

    <!-- Responsive CSS -->
    <link rel="stylesheet" href="/css/responsive.css">

    <!-- Google Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway:300,400,700' rel='stylesheet' type='text/css'>
</head>

<body>
  <div class="site">
    <div class="sidebar" id="sidebar">
      <div class="header">
        <h1 class="title"><a href="/about"><img id="logo" src="/images/logo.png"></a></h1>
        <span class="tagline">Heva Wu's Blog</span>
        <span class="motto">I may not be there yet, but I'm closer than I was yesterday. </span>
        <span class="motto">(￣︶￣)↗[GO!]</span>
      </div>
      <div class="sidebar-info">
        <ul class="sidebar-info-list">
          <li class="sidebar-info-link">
              <a href="/blog/tags" class="">Tags</a>
          </li>
          <li>
              <a href="/blog/categories" class="">Categories</a>
          </li>
          <li>
              <a href="/blog.html" class="footer-link">Latest Blog</a>
          </li>
        </ul>
      </div>
      <div class="footer">
        <span id="footer-links">
          <a href="/about" class="footer-link">About</a> <span class="separator">•</span>
          <a href="https://www.linkedin.com/in/he-heva-wu-2a6819113/" class="footer-link">LinkedIn</a> <span class="separator">•</span>
          <a href="https://github.com/HevaWu" class="footer-link">GitHub</a>
        </span>
      </div>
    </div>

    <div class="content" id="home">
  <div id="sidebar-button">
    <img src="/images/sidebar-button.png">
  </div>

  <div id="post-info">
    <div id="cover-photo-container">
      
    </div>
    <div id="info-container">
      <h1 id="title">Be Careful Using `Named Color` at Xcode Xib File</h1>
      <time datetime="2019-07-04T00:30:00+09:00" itemprop="datePublished">
        Jul 4, 2019
      </time>
      <div id="tag-category-container">
           
          
          <a href="/blog/tags/#ios" class="post-tag">iOS</a>
          
          <a href="/blog/tags/#xcode" class="post-tag">Xcode</a>
          
          <a href="/blog/tags/#xib" class="post-tag">XIB</a>
          
          <a href="/blog/tags/#named-color" class="post-tag">Named Color</a>
          
          
          <p></p>
           
          
          <a href="/blog/categories/#ios" class="post-category">iOS</a>
          
          <a href="/blog/categories/#xcode" class="post-category">Xcode</a>
          
          <a href="/blog/categories/#xib" class="post-category">XIB</a>
          
          <a href="/blog/categories/#named-color" class="post-category">Named Color</a>
          
          
      </div>
    </div>
  </div>

  <div class="post">
    <p>At WWDC 2019, Apple introduced the nice dark mode color settings.
By adding the dark mode color settings, Apple suggest to define <code class="highlighter-rouge">Named Color</code> at <code class="highlighter-rouge">Assets.xsassets</code>.
However, during implementation, there is an issue, and we should pay attetion on it.</p>

<p>I will first introduce how to add &amp; use the <code class="highlighter-rouge">Named Color</code>,
then introduce the problems.</p>

<p>At first, I have a <code class="highlighter-rouge">TabBarController</code> based project.
I could switch my view controllers (FirstViewController, SecondViewController) by using the tab bar.</p>

<h2 id="add-new-color-set">Add New Color Set</h2>
<ul>
  <li>Open <code class="highlighter-rouge">Assets.xcassets</code>
</li>
  <li>Click <code class="highlighter-rouge">+</code> and choosing <code class="highlighter-rouge">New Color Set</code>, then you could naming it(I add a <code class="highlighter-rouge">TabBarItemLabelColor</code>)</li>
</ul>

<p><img src="/images/2019-07-03-Be-Careful-Using-Named-Color-at-Xcode-Xib-File/color_set.png" width="100%"></p>
<ul>
  <li>Under <code class="highlighter-rouge">Attributes Inspector</code>, set the <code class="highlighter-rouge">Color</code> params</li>
</ul>

<h2 id="use-new-color-set">Use New Color Set</h2>
<ul>
  <li>At <code class="highlighter-rouge">xib</code> file, we could directly select the color under <code class="highlighter-rouge">Attributes Inspector</code>
</li>
</ul>

<p><img src="/images/2019-07-03-Be-Careful-Using-Named-Color-at-Xcode-Xib-File/xib.png" width="100%"></p>
<ul>
  <li>At coding part, we could directly call <code class="highlighter-rouge">UIColor(named: "TabBarItemLabelColor")</code> to use it</li>
</ul>

<h2 id="problems-be-careful-bomb-">Problems (Be Careful <img class="emoji" title=":bomb:" alt=":bomb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a3.png" height="20" width="20"> )</h2>
<p>OK. Now back to our main point.</p>

<h3 id="if-you-are-using-named-color-at-the-xib-file-please-be-carefule-to-change-it-at-the-coding-part">If you are using <code class="highlighter-rouge">Named Color</code> at the <code class="highlighter-rouge">xib</code> file, please be carefule to change it at the coding part</h3>
<p>Since we add a new color set at the <code class="highlighter-rouge">Assets.xcassets</code>,
so of course we could directly call it at the <code class="highlighter-rouge">xib</code> file.</p>

<p><strong>But</strong> If you will <code class="highlighter-rouge">rewrite</code> this variable in the later coding part.
Then you should be careful.</p>

<p>At the first, I thought we could rewrite the color at the code part where we want.
(Same as before). However, I found my color is not updated (showing correctly)
at the first time. <img class="emoji" title=":disappointed:" alt=":disappointed:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f61e.png" height="20" width="20"></p>

<p>Then I try to find the reason.</p>

<p>For what I am testing is :</p>
<ul>
  <li>Add an <code class="highlighter-rouge">label color</code> observer at the <code class="highlighter-rouge">viewDidLoad</code> part (where I prepare to rewrite the color). I tried to use this observer to help checking how the color changes.
    <div class="language-swift highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

  <span class="n">firstLabel</span><span class="o">.</span><span class="n">textColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">red</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">firstLabel</span><span class="o">.</span><span class="n">textColor</span><span class="p">)</span>

  <span class="c1">// observer for checking if the color is changed</span>
  <span class="n">observer</span> <span class="o">=</span> <span class="n">firstLabel</span><span class="o">.</span><span class="nf">observe</span><span class="p">(\</span><span class="o">.</span><span class="n">textColor</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">change</span><span class="p">)</span> <span class="k">in</span>
     <span class="nf">print</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">textColor</span><span class="p">,</span> <span class="kd">#line</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>And I got this output</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kt">Optional</span><span class="p">(</span><span class="kt">UIExtendedSRGBColorSpace</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span>
    <span class="kt">Optional</span><span class="p">(</span><span class="n">kCGColorSpaceModelRGB</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">0.5</span> <span class="p">)</span> <span class="mi">38</span>
</code></pre></div></div>

<p>The first line is <code class="highlighter-rouge">print</code> line, so we <strong>do</strong> rewrite the color
The second line shows the label’s color changed later.</p>

<p>I have no idea when the label’s color changed.
But I tried to put the <code class="highlighter-rouge">label.color = .red</code> rewrite color code at
<code class="highlighter-rouge">variabe's didSet{}</code> &amp; <code class="highlighter-rouge">viewDidLayoutSubview()</code> &amp; <code class="highlighter-rouge">viewWillAppear()</code> part.
All of them cannot rewrite the color succesfully.
Except <code class="highlighter-rouge">viewDidAppear()</code>
You could checking them in this file
https://github.com/HevaWu/TestColorAssets/blob/master/TestColorAssets/TestColorAssets/FirstViewController.swift</p>

<p>I don’t know the detail implementation about the <code class="highlighter-rouge">Named Color</code></p>

<p>For what I am thinking is:
Maybe reading the <code class="highlighter-rouge">color</code> from <code class="highlighter-rouge">Assets.xsassets</code> takes some time &amp; calculation.</p>

<p>At the <code class="highlighter-rouge">xib</code> file part, if we checking its code</p>

<p><img src="/images/2019-07-03-Be-Careful-Using-Named-Color-at-Xcode-Xib-File/text_color.png" width="100%"></p>

<p>So Xcode read the color by its <code class="highlighter-rouge">name</code>
And in the <code class="highlighter-rouge">resources</code> part</p>

<p><img src="/images/2019-07-03-Be-Careful-Using-Named-Color-at-Xcode-Xib-File/resources.png" width="100%">
Xcode will try to find the <code class="highlighter-rouge">named Color</code> by reading its resources</p>

<p>This <code class="highlighter-rouge">finding</code> might take some times.</p>

<p>Because if we set the <code class="highlighter-rouge">dark mode</code> colors, Xcode will first reading the device
environment, then try to update/fit the colors.
But during this time <code class="highlighter-rouge">viewDidLoad()</code> has already finished.</p>

<p>So even we rewrite the label’s color in it,
it still be replaced by <code class="highlighter-rouge">xib</code> file <code class="highlighter-rouge">Named Color</code></p>

<h2 id="conclusion">Conclusion</h2>
<ul>
  <li>If you are not using <code class="highlighter-rouge">Named Color</code> at the <code class="highlighter-rouge">xib</code> file part &lt;- everything goes well</li>
  <li>If you are using <code class="highlighter-rouge">Named Color</code> at the <code class="highlighter-rouge">xib</code> file
    <ul>
      <li>You will not change this color in the code part &lt;- everythin goes well</li>
      <li>You will/might change this color later (be carefule)
        <ul>
          <li>You shouldn’t change the color at <code class="highlighter-rouge">didSet{}</code>, <code class="highlighter-rouge">viewDidLoad()</code>, <code class="highlighter-rouge">viewDidLayoutSubviews()</code>, <code class="highlighter-rouge">viewWillAppear()</code>
</li>
          <li>You could change the color at <code class="highlighter-rouge">viewDidAppear()</code> (If you find other places we could rewrite it, please tell me <img class="emoji" title=":+1:" alt=":+1:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f44d.png" height="20" width="20"> )</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="at-the-end">At the end</h2>
<p>Thank you for the reading. Please feel free to tell me if I wrote anything wrong. <img class="emoji" title=":relaxed:" alt=":relaxed:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/263a.png" height="20" width="20"></p>

<h4 id="link">Link</h4>
<p>https://github.com/HevaWu/TestColorAssets</p>

  </div>
  <div class="colophon">
    <p>
      <span id="pub-date">Published on 04 Jul 2019</span> <span class="separator">•</span>
      <span id="social">Find me on <a href="">Twitter</a>!</span>
    </p>
  </div>

  <!-- Add Disqus comments. -->
  <div id="disqus_thread"></div>
  <script src="/scripts/disqus.js" type="text/javascript"></script>
  <script id="dsq-count-scr" src="//hevawu-github-io.disqus.com/count.js" async></script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>


  </div>
  <script src="/scripts/responsive.js" type="text/javascript"></script>
</body>

</html>